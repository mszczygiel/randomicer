(this["webpackJsonprandomicer-web"]=this["webpackJsonprandomicer-web"]||[]).push([[0],{77:function(e,t,n){e.exports=n(88)},82:function(e,t,n){},83:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(20),u=n.n(o),c=(n(82),n(83),n(72)),l=n(19),i=n(13),m=n(16),s=n(38),d=n(25),h=n(37),b=Object(h.createAction)("@randomicer/MICE_LOADED")(),p=Object(h.createAction)("@randomicer/RANDOMIZATION_STARTED")(),f=Object(h.createAction)("@randomicer/SET_DISTRIBUTION")(),E=Object(h.createReducer)({mice:[],isRunningRandomization:!1}).handleType("@randomicer/MICE_LOADED",(function(e,t){return Object(d.a)(Object(d.a)({},e),{},{mice:t.payload.mice})})).handleType("@randomicer/RANDOMIZATION_STARTED",(function(e,t){return Object(d.a)(Object(d.a)({},e),{},{isRunningRandomization:!0})})).handleType("@randomicer/SET_DISTRIBUTION",(function(e,t){return Object(d.a)(Object(d.a)({},e),{},{distribution:t.payload,isRunningRandomization:!1})})),v=n(39),g=Object(m.b)((function(e){return{mice:e.mice}}))((function(e){return r.a.createElement(v.a,{hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"mouse id"),r.a.createElement("th",null,"tumors"),r.a.createElement("th",null,"volume"))),r.a.createElement("tbody",null,e.mice.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.tumors.length),r.a.createElement("td",null,e.tumorsVolume()))}))))})),O=n(10),j=n(27),w=n(73),N=n(22),y=n(28),T=function(){function e(t,n){Object(N.a)(this,e),this.width=void 0,this.height=void 0,this.width=t,this.height=n}return Object(y.a)(e,[{key:"volume",value:function(){var e=Math.min(this.width,this.height);return.5*e*e*Math.max(this.width,this.height)}}]),e}(),x=function(){function e(t,n){Object(N.a)(this,e),this.id=void 0,this.tumors=void 0,this.id=t,this.tumors=Array.from(n)}return Object(y.a)(e,[{key:"tumorsVolume",value:function(){return this.tumors.map((function(e){return e.volume()})).reduce((function(e,t){return t+e}),0)}}]),e}(),S=n(68),M=n(74),R=n(101),V=n(92),_=n(69),D=n(93),z=n(94),A=n(95);function k(e){var t=Object(S.parse)(e,{delimiter:";",skipEmptyLines:!0}),n=[];return M.a(t.data).pipe(Object(V.a)(2),Object(_.a)((function(e){return function(e,t){var n=e[0].trim(),a=[];return R.a(M.a(e),M.a(t)).pipe(Object(z.a)(1),Object(_.a)((function(e){var t=Object(O.a)(e,2),n=t[0],a=t[1];return[n.trim().replace(",","."),a.trim().replace(",",".")]})),Object(A.a)((function(e){var t=Object(O.a)(e,2),n=t[0],a=t[1];return n.length>0&&a.length>0})),Object(_.a)((function(e){var t=Object(O.a)(e,2),n=t[0],a=t[1];return new T(Number.parseFloat(n),Number.parseFloat(a))})),Object(D.a)()).subscribe((function(e){return a=e})),new x(n,a)}(e[0],e[1])})),Object(D.a)()).subscribe((function(e){return n=e})),n}var I={onLoaded:b},F=Object(m.b)(void 0,I)((function(e){function t(t){var n;if("string"===typeof(null===(n=t.target)||void 0===n?void 0:n.result)){var a=k(t.target.result);e.onLoaded({mice:a})}}return r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"file",accept:".txt,.csv,text/plain,text/csv",onChange:function(e){var n,a=null===(n=e.target.files)||void 0===n?void 0:n.item(0);if(a){var r=new FileReader;r.onloadend=t,r.readAsText(a)}}}))})),C=n(63),L=n(99),G=n(100),U=n(102),P=n(96),B=n(55),X=n(97),J=n(98),W=function(){function e(t){Object(N.a)(this,e),this.mice=void 0,this.mice=t}return Object(y.a)(e,[{key:"tumorsMedian",value:function(){return Object(L.d)(this.volumes())}},{key:"tumorsMean",value:function(){return Object(L.c)(this.volumes())}},{key:"tumorsStdDev",value:function(){return Object(L.f)(this.volumes())}},{key:"volumes",value:function(){return this.mice.map((function(e){return e.tumorsVolume()}))}}]),e}(),Z=function(){function e(t){Object(N.a)(this,e),this.groups=void 0,this.groups=t}return Object(y.a)(e,[{key:"penalty",value:function(){var e=this,t=0,n=Object(L.g)(this.groups.map((function(e){return e.tumorsMean()}))),a=Object(L.g)(this.groups.map((function(e){return e.tumorsMedian()}))),r=Object(L.b)(1,Object(L.g)(this.groups.map((function(e){return e.tumorsStdDev()}))));return M.a(this.groups).pipe(Object(P.a)((function(t){return M.a(e.groups).pipe(Object(_.a)((function(e){return[t,e]})))}))).pipe(Object(B.a)((function(e,t){var o=Object(O.a)(t,2);return e+function(e,t){var o=Object(L.a)(e.tumorsMean()-t.tumorsMean())/n;return 2*(Object(L.a)(e.tumorsMedian()-t.tumorsMedian())/a)+o+Object(L.a)(e.tumorsStdDev()-t.tumorsStdDev())/r}(o[0],o[1])}),0)).subscribe((function(e){t=e})),t}}]),e}(),q=function e(t){Object(N.a)(this,e),this.message=void 0,this.message=t};function $(e,t){var n=Object(L.b)(1e3,Object(L.e)(e.length*e.length,1e4)),a=e.filter((function(e){return null==t.minTumorsVolume||e.tumorsVolume()>=t.minTumorsVolume})).filter((function(e){return null==t.maxTumorsVolume||e.tumorsVolume()<=t.maxTumorsVolume})),r=t.micePerGroup*t.numberOfGroups;if(r>a.length)return new q("Number of mice meeting criteria (".concat(a.length,") is less than number of groups x number of mice per group (").concat(r,")"));var o={initialState:Object(C.a)(a),iterate:function(e){return function(e){var t=e.length,n=Object(C.a)(e);for(;0!==t;){var a=Math.floor(Math.random()*t),r=n[t-=1];n[t]=n[a],n[a]=r}return n}(e)},resultSelector:function(e){return e},scheduler:G.a};return U.a(o).pipe(Object(X.a)(n),Object(P.a)((function(e){return function(e){return M.a(e).pipe(Object(X.a)(r),Object(V.a)(t.micePerGroup),Object(D.a)(),Object(_.a)((function(e){return e.map((function(e){return new W(e)}))})),Object(_.a)((function(e){return new Z(e)})))}(e)})),Object(J.a)((function(e,t){return e.penalty()-t.penalty()}))).toPromise()}var H={setRandomizationResult:f,randomizationStarted:p},K=Object(m.b)((function(e){return{mice:e.mice,randomizationRunning:e.isRunningRandomization}}),H)((function(e){var t=Object(a.useState)(2),n=Object(O.a)(t,2),o=n[0],u=n[1],c=Object(a.useState)(2),m=Object(O.a)(c,2),s=m[0],d=m[1],h=Object(a.useState)(void 0),b=Object(O.a)(h,2),p=b[0],f=b[1],E=Object(a.useState)(void 0),v=Object(O.a)(E,2),g=v[0],N=v[1],y=Object(a.useState)(""),T=Object(O.a)(y,2),x=T[0],S=T[1],M=e.mice.length>1&&!e.randomizationRunning;return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,null,r.a.createElement(i.a,{className:"text-center"},r.a.createElement(F,null))),r.a.createElement(l.a,null,r.a.createElement(i.a,null,r.a.createElement("label",{htmlFor:"no-of-groups"},"No of groups"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{id:"no-of-groups",className:"form-control",type:"number",placeholder:"No of groups",min:"2",value:o,onChange:function(e){return u(e.target.valueAsNumber)}}))),r.a.createElement(i.a,null,r.a.createElement("label",{htmlFor:"mice-per-group"},"Mice per group"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{id:"mice-per-group",className:"form-control",type:"number",placeholder:"Mice per group",min:"2",value:s,onChange:function(e){return d(e.target.valueAsNumber)}}))),r.a.createElement(i.a,null,r.a.createElement("label",{htmlFor:"lower-tumor-threshold"},"Min TV"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{id:"lower-tumor-threshold",className:"form-control",type:"number",step:"0.01",placeholder:"Lower TV threshold",min:"0",value:p||"",onChange:function(e){""===e.target.value?f(void 0):f(e.target.valueAsNumber)}}))),r.a.createElement(i.a,null,r.a.createElement("label",{htmlFor:"upper-tumor-threshold"},"Max TV"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{id:"upper-tumor-threshold",className:"form-control",type:"number",step:"0.01",placeholder:"Upper TV threshold",min:"0",value:g||"",onChange:function(e){""===e.target.value?N(void 0):N(e.target.valueAsNumber)}})))),r.a.createElement(l.a,null,r.a.createElement(i.a,null,x.trim().length>0?r.a.createElement(w.a,{variant:"danger"},x):null)),r.a.createElement(l.a,{className:"mt-3"},r.a.createElement(i.a,{className:"text-center"},r.a.createElement(j.a,{disabled:!M,className:"btn btn-primary",onClick:function(){return function(){var t=$(e.mice,{micePerGroup:s,numberOfGroups:o,minTumorsVolume:p,maxTumorsVolume:g});t instanceof q?S(t.message):t instanceof Promise&&(e.randomizationStarted(),t.then((function(t){return e.setRandomizationResult(t)})))}()}},e.randomizationRunning?r.a.createElement("span",{className:"spinner-border spinner-border-sm",role:"status"}):null,"Randomize"))))})),Q=function(e){var t=["_ _","o _","_ o","o o","oo _","_ oo","oo oo","o oo","oo o"];var n=new File(e.distribution.groups.map((function(e,n){return function(e,n){var a="Sym;LP;TV;NT;G".concat(n,";AVG;").concat(e.tumorsMean(),";MED;").concat(e.tumorsMedian(),";SD;").concat(e.tumorsStdDev()),r="";return e.mice.sort((function(e,t){return t.tumorsVolume()-e.tumorsVolume()})).forEach((function(e,n){r+="".concat(t[n%t.length],";").concat(e.id,";").concat(e.tumorsVolume(),";").concat(e.tumors.length,"\n")})),"".concat(a,"\n").concat(r)}(e,n+1)})),"result.csv"),a=URL.createObjectURL(n);return r.a.createElement("a",{href:a,download:!0},r.a.createElement(j.a,{variant:"success"},"Download"))},Y=function(e){var t=e.group.mice.sort((function(e,t){return t.tumorsVolume()-e.tumorsVolume()}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"G",e.id+1," AVG(",e.group.tumorsMean().toFixed(3),") MED(",e.group.tumorsMedian().toFixed(3),") SD(",e.group.tumorsStdDev().toFixed(3),")"),r.a.createElement(v.a,{size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"id"),r.a.createElement("th",null,"TV"),r.a.createElement("th",null,"NT"))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:"mouse-".concat(e.id)},r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.tumorsVolume()),r.a.createElement("td",null,e.tumors.length))})))))},ee=Object(m.b)((function(e){return{distribution:e.distribution}}))((function(e){return void 0===e.distribution?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{distribution:e.distribution}),e.distribution.groups.map((function(e,t){return r.a.createElement(Y,{key:"group-".concat(t),group:e,id:t})})))})),te=n(71),ne=function(e){var t=Object(a.useState)(!1),n=Object(O.a)(t,2),o=n[0],u=n[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{variant:"secondary",size:"sm",onClick:function(){return u(!o)},"aria-expanded":o},r.a.createElement("svg",{className:"bi bi-question-circle",width:"2em",height:"2em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{"fill-rule":"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),r.a.createElement("path",{d:"M5.25 6.033h1.32c0-.781.458-1.384 1.36-1.384.685 0 1.313.343 1.313 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.007.463h1.307v-.355c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.326 0-2.786.647-2.754 2.533zm1.562 5.516c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"}))),r.a.createElement(te.a,{in:o},r.a.createElement("div",{className:"text-justify"},r.a.createElement("h5",null,"File format:"),r.a.createElement("p",null,"Each mouse entry spans 2 rows and N columns (where N = max number of tumors in any mouse). Columns are separated with ",r.a.createElement("em",null,";")),r.a.createElement("p",null,"For example, to represent 5 mice, where mouse with id 2 has two tumors (3.5x4.1 and 1.2x2.1), whereas rest have 1 (all 3.5x4.1) one could prepare file with the following content:"),r.a.createElement("pre",null,"1;3.5;",r.a.createElement("br",null),";4.1;",r.a.createElement("br",null),"2;3.5;1.2",r.a.createElement("br",null),";4.1;2.1",r.a.createElement("br",null),"3;3.5;",r.a.createElement("br",null),";4.1;",r.a.createElement("br",null),"4;4.1;",r.a.createElement("br",null),";3.5;",r.a.createElement("br",null),"5;3.5;",r.a.createElement("br",null),";4.1;"),r.a.createElement("h5",null,"Issues"),r.a.createElement("p",null,"If you encounter any issue or have improvement idea, please use raise issue on ",r.a.createElement("a",{href:"https://github.com/mszczygiel/randomicer/issues",target:"__blank"},"Github")))))},ae=Object(s.b)(E,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());var re=function(){return r.a.createElement(m.a,{store:ae},r.a.createElement(c.a,null,r.a.createElement(l.a,{className:"align-items-center"},r.a.createElement(i.a,{className:"text-center"},r.a.createElement("h1",{className:"text-primary"},"Randomicer"))),r.a.createElement(l.a,null,r.a.createElement(i.a,{sm:{offset:6},className:"text-right"},r.a.createElement(ne,null))),r.a.createElement(K,null),r.a.createElement("hr",null),r.a.createElement(l.a,null,r.a.createElement(i.a,null,r.a.createElement("h3",{className:"text-center"},"Input"),r.a.createElement(g,null)),r.a.createElement(i.a,{className:"text-center"},r.a.createElement("h3",null,"Output"),r.a.createElement(ee,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[77,1,2]]]);
//# sourceMappingURL=main.cd2bc62a.chunk.js.map